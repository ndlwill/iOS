https://developer.apple.com/documentation/swiftui/view/environment(_:)

Instance Method
environment(\_:)
Places an observable object in the view’s environment.
iOS 17.0+

Parameters
object
The object to set for this object’s type in the environment, or nil to clear an object of this type from the environment.

Return Value
A view that has the specified object in its environment.



Use this modifier to place an object that you declare with the Observable() macro (iOS 17.0) into a view’s environment. 
For example, you can add an instance of a custom observable Profile class to the environment of a ContentView:

@Observable class Profile { ... }

struct RootView: View {
    @State private var currentProfile: Profile?

    var body: some View {
        ContentView()
            .environment(currentProfile) // 注入环境 Injecting custom objects into a view’s environment
    }
}

You then read the object inside ContentView or one of its descendants using the Environment property wrapper:

struct ContentView: View {
    @Environment(Profile.self) private var currentProfile: Profile

    var body: some View { ... }
}

This modifier affects the given view, as well as that view’s descendant views. 
It has no effect outside the view hierarchy on which you call it. 
The environment of a given view hierarchy holds only one observable object of a given type.


Note
This modifier takes an object that conforms to the Observable protocol(Observation/Observable: https://developer.apple.com/documentation/Observation/Observable). 
To add environment objects that conform to the ObservableObject protocol, use environmentObject(_:) instead.
// iOS 13.0
https://developer.apple.com/documentation/Combine/ObservableObject
// iOS 13.0
https://developer.apple.com/documentation/swiftui/view/environmentobject(_:)


// A property wrapper that reads a value from a view’s environment.
https://developer.apple.com/documentation/swiftui/environment
// Sets the environment value of the specified key path to the given value.
https://developer.apple.com/documentation/swiftui/view/environment(_:_:)


==================================================
@Environment(\.library) 
@Environment(Library.self)

1. 老写法（key path 方式）
\.library 是 EnvironmentValues 上定义的一个 key path。
背后实现是你定义了一个 EnvironmentKey，然后在 EnvironmentValues 里加了一个属性
private struct LibraryKey: EnvironmentKey {
    static let defaultValue = Library()
}

extension EnvironmentValues {
    var library: Library {
        get { self[LibraryKey.self] }
        set { self[LibraryKey.self] = newValue }
    }
}


2. 新写法（Swift 5.9+ 宏方式）
直接用类型作为 Key，不用自己写 EnvironmentKey
编译器会自动帮你生成类似上面的 LibraryKey 和 EnvironmentValues 扩展。


@Environment(\.library)：传统方式，基于 key path，需要手动扩展 EnvironmentValues。
@Environment(Library.self)：新方式（iOS 17 / Swift 5.9），基于类型，编译器自动生成 EnvironmentKey。