https://github.com/pointfreeco/swift-composable-architecture

The Composable Architecture (TCA, for short) is a library for building applications in a consistent and understandable way, 
with composition, testing, and ergonomics in mind. 
It can be used in SwiftUI, UIKit, and more, and on any Apple platform (iOS, macOS, iPadOS, visionOS, tvOS, and watchOS).


TCA（The Composable Architecture）就是一个应用架构。
它不是 UI 框架，不是状态管理工具那么简单，而是一整套：
状态管理 + 副作用管理 + 依赖注入 + 可测试性
的应用架构体系

类似 Redux，但完全 Swift 化、类型安全、并发友好。

核心理念：
State
Action
Reducer
Store
Effect
Dependency



@Reducer
struct CounterFeature {

    struct State: Equatable {
        var count = 0
    }

    enum Action {
        case increment
        case decrement
    }

    var body: some ReducerOf<Self> {
        Reduce { state, action in
            switch action {
            case .increment:
                state.count += 1
                return .none

            case .decrement:
                state.count -= 1
                return .none
            }
        }
    }
}


let store = Store(
    initialState: CounterFeature.State()
) {
    CounterFeature()
}

| 层级      | 作用     |
| ------- | ------ |
| State   | 单一数据源  |
| Action  | 所有行为   |
| Reducer | 状态变化逻辑 |
| Effect  | 副作用    |
| Store   | 状态容器   |

这是一种 单向数据流架构（Unidirectional Data Flow）。

| MVVM  | TCA        |
| ----- | ---------- |
| 状态分散  | 单一状态树      |
| 逻辑分散  | Reducer 集中 |
| 副作用随意 | Effect 管理  |
| 测试困难  | 原生支持测试     |


为什么它强调“Composable”？
Composable = 可组合
意思是：
大功能 = 小功能组合

AppFeature
  ├── LoginFeature
  ├── ProfileFeature
  └── SettingsFeature

每个 Feature 都是：
State + Action + Reducer
可以独立测试。


1️⃣ 极强可测试性
let store = TestStore(
    initialState: ...
) {
    Feature()
}

await store.send(.increment) {
    $0.count = 1
}


2️⃣ 副作用清晰
网络请求、时间、依赖，都必须通过 Effect。


TCA 本质是什么？
一句话：
用函数式思想重构 iOS 架构。


它把：
状态变更 → 纯函数
副作用 → 显式管理
依赖 → 可注入
逻辑 → 可组合