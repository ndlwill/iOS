https://www.jianshu.com/p/89ed22f50a9c

lineHeight = ascent + descent + leading
iOSæ–‡æœ¬å®¹å™¨ä¸­éƒ½æ˜¯åŸºçº¿å¯¹é½ï¼Œæ‰€è°“çš„åŸºçº¿å¯¹é½å°±æ˜¯æŒ‡æ— è®ºä¸­æ–‡å­—ç¬¦ï¼Œæ•°å­—ï¼Œè‹±æ–‡å­—ç¬¦ï¼Œè¡¨æƒ…ç­‰å®ƒä»¬åœ¨ä¸€è¡Œçš„æ—¶å€™ï¼ŒåŸºçº¿æ˜¯åœ¨åŒä¸€é«˜åº¦çš„ã€‚

pointSizeå’ŒUIFontçš„å­—ä½“å¤§å°ä¸€è‡´
ascenderæ˜¯åŸºçº¿ä¹‹ä¸Šçš„é«˜åº¦ï¼Œé€šå¸¸ä¸ºæ­£
decenderæ˜¯åŸºçº¿ä¹‹ä¸‹çš„é«˜åº¦ï¼Œé€šå¸¸ä¸ºè´Ÿ
descender + ascender + leadingè®¡ç®—å‡ºçš„é«˜åº¦åœ¨æ²¡æœ‰è¡Œé—´è·å’Œæ®µé—´è·è·å¹¶ä¸”lineHeightMultiple=1çš„æƒ…å†µä¸‹å’ŒboundingRectWithSizeHeightè®¡ç®—å‡ºçš„é«˜åº¦ä¸€è‡´ã€‚


NSMutableParagraphStyle *ParagraphStyle =  [[NSMutableParagraphStyle alloc] init];
ParagraphStyle.lineHeightMultiple = 1;
ParagraphStyle.lineSpacing = 0;
ParagraphStyle.paragraphSpacing = 0;
ParagraphStyle.paragraphSpacingBefore = 0;

NSDictionary *dic1 = @{NSFontAttributeName:[UIFont systemFontOfSize:30],
                        NSForegroundColorAttributeName:[UIColor blackColor],
                        NSBackgroundColorAttributeName:[UIColor yellowColor],
                        NSBaselineOffsetAttributeName:@0,
                        NSParagraphStyleAttributeName:ParagraphStyle
                        };
NSDictionary *dic2 = @{NSFontAttributeName:[UIFont systemFontOfSize:30],
                        NSForegroundColorAttributeName:[UIColor redColor],
                        NSBackgroundColorAttributeName:[UIColor yellowColor],
                        NSBaselineOffsetAttributeName:@0,
                        NSParagraphStyleAttributeName:ParagraphStyle
                        };

NSDictionary *dic3 = @{NSFontAttributeName:[UIFont systemFontOfSize:30],
                        NSForegroundColorAttributeName:[UIColor blueColor],
                        NSBackgroundColorAttributeName:[UIColor yellowColor],
                        NSBaselineOffsetAttributeName:@0,
                        NSParagraphStyleAttributeName:ParagraphStyle
                        };
NSMutableAttributedString *attributeStr1 =  [[NSMutableAttributedString alloc] initWithString:@"æŸ¯æ™“çª" attributes:dic1];
NSAttributedString *attributeStr2 =  [[NSAttributedString alloc] initWithString:@" 1234567890" attributes:dic2];
NSAttributedString *attributeStr3 =  [[NSAttributedString alloc] initWithString:@" ğŸ˜†jqLvQ" attributes:dic3];
[attributeStr1 appendAttributedString:attributeStr3];
[attributeStr1 appendAttributedString:attributeStr2];

NSTextAttachment *attachment = [[NSTextAttachment alloc] init];
attachment.image = [UIImage imageNamed:@"tsj"];
attachment.bounds = CGRectMake(0,0,[UIFont systemFontOfSize:30].ascender,[UIFont systemFontOfSize:30].ascender);

[attributeStr1 appendAttributedString:[NSAttributedString attributedStringWithAttachment:attachment]];

CGRect rect = [attributeStr1 boundingRectWithSize:CGSizeMake(600, MAXFLOAT) options:NSStringDrawingUsesLineFragmentOrigin | NSStringDrawingUsesFontLeading context:NULL];

NSLog(@"lineHeight : %f",[UIFont systemFontOfSize:30].lineHeight);
NSLog(@"pointSize : %f",[UIFont systemFontOfSize:30].pointSize);
NSLog(@"descender : %f",[UIFont systemFontOfSize:30].descender);
NSLog(@"ascender : %f",[UIFont systemFontOfSize:30].ascender);
NSLog(@"leading : %f",[UIFont systemFontOfSize:30].leading);

NSLog(@"descender + ascender + leading = %f",[UIFont systemFontOfSize:30].ascender - [UIFont systemFontOfSize:30].descender + [UIFont systemFontOfSize:30].leading);
NSLog(@"boundingRectWithSizeHeight : %f",rect.size.height);

UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 100, 600, 100)];
label.attributedText = attributeStr1;
label.numberOfLines = 0;
[self.view addSubview:label];


/*

2018-03-12 14:00:34.619455+0800 JQ_textView[13941:5472023] lineHeight : 35.800781
2018-03-12 14:00:34.619537+0800 JQ_textView[13941:5472023] pointSize : 30.000000
2018-03-12 14:00:34.619556+0800 JQ_textView[13941:5472023] descender : -7.236328
2018-03-12 14:00:34.619573+0800 JQ_textView[13941:5472023] ascender : 28.564453
2018-03-12 14:00:34.619596+0800 JQ_textView[13941:5472023] leading : 0.000000
2018-03-12 14:00:34.619614+0800 JQ_textView[13941:5472023] descender + ascender + leading = 35.800781
2018-03-12 14:00:34.619627+0800 JQ_textView[13941:5472023] boundingRectWithSizeHeight : 35.800781

*/

NSTextAttachmenté»˜è®¤ä¹Ÿæ˜¯åŸºçº¿å¯¹é½ï¼Œattachment.boundsçš„åæ ‡åŸç‚¹Yè½´æ˜¯å’ŒåŸºçº¿æŒå¹³ï¼Œæ˜¯coregraphicsçš„åæ ‡ç³»ã€‚